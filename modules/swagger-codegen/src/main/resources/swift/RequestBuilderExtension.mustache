//  RequestBuilderExtension.swift
//
//  Generated by swagger-codegen
//  Copyright Â© 2016 OVH SAS. All rights reserved.
//

import CryptoSwift

extension RequestBuilder {

    public func addAuthenticationHeaders(signed: Bool, consumerKey: String? = nil) {
        var jsonBody = ""
        if let parameters = parameters where isBody && signed {
            do {
                let data = try NSJSONSerialization.dataWithJSONObject(parameters, options: [])
                jsonBody = String(data: data, encoding: NSUTF8StringEncoding)!
            } catch let error {
                debugPrint("error while serializing JSON: \(error)")
            }
        }

        if let headers = Credentials.sharedCredentials.getAuthenticationHeadersWithSignature(signed, consumerKey: consumerKey, url: URLString, method: method, andBody: jsonBody) {
            addHeaders(headers)
        }
    }

}
